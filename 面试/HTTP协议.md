# HTTP协议

## 浏览器背后的故事

![1583072062949](C:\Users\刘如刚\AppData\Roaming\Typora\typora-user-images\1583072062949.png)

HTTP 

+ 超文本传输协议(http)是一种通信协议，它允许将超文本标记语言(HTML)文档从web服务器传输到客户端的浏览器
+ HTTP是一个属于应用层的面向对象的协议，由于其简捷，快速的方式，适用于分布式超媒体信息系统。它于1990奶奶提出，经过几年的使用与发展，得到不断地完善和扩展

web与HTTP

+ web是一种基于超文本和HTTP的，全球性的，动态交互的，跨平台的分布式图形信息系统

+ 建立在Internet上的一种网络服务，为浏览者在Internet上查找和浏览信息提供了图形化的，易于访问的直观界面，其中的文档及超链接将Internet上的信息节点组织成一个护卫关联的网络结构

## HTTP协议的前世今生

![1583072584548](C:\Users\刘如刚\AppData\Roaming\Typora\typora-user-images\1583072584548.png)

## 透过TCP/IP看HTTP

+ HTTP协议是构建在TCP/IP协议之上的，是TCP/IP协议的一个子集

TCP/IP协议族

+ TCP/IP协议其实是一系列与互联网相关的协议几个起来的总称
+ 分层管理是TCP/IP协议的重要特征

TCP/IP协议族分层

+ TCP/IP协议族是一个四层协议组成的系统，这四层分别为：应用层，传输层，网络层和数据链路层

应用层·

应用层一般是我们编写的应用程序，决定了向用户提供的应用服务。应用层可以通过系统调用与传输层进行通信

如：FTP，DNS，HTTP等

传输层

+ 传输层通过系统调用向应用层提供处于网络连接中对的两台计算机之间的数据传输功能
+ 在传输层有两个性质不同的协议：TCP和UDP

网络层

+ 网络层用来处理在网络上流动的数据包，数据包是网络传输的最小数据单位。该层规定了通过怎样的路径(传输路线)到达对方计算机，并把数据包传输给对方

链路层

+ 链路层用来处理连接网络的硬件部分，包括控制操作系统硬件设备驱动,网卡，网络适配器以及光纤等物理可见部分。硬件上的范畴均在链路层的作用范围之内

![1583073563621](C:\Users\刘如刚\AppData\Roaming\Typora\typora-user-images\1583073563621.png)

#### 数据包的封装过程

![1583073632649](C:\Users\刘如刚\AppData\Roaming\Typora\typora-user-images\1583073632649.png)

#### HTTP数据传输过程

+ 发送端发送数据时，数据会从上层传输到下层，且每经过一层都会被打上该层的头部信息。而接收端接收数据时，数据会从下层传输到上层，传输前会把下层的头部信息删除

![1583073852167](C:\Users\刘如刚\AppData\Roaming\Typora\typora-user-images\1583073852167.png)

#### 传输层---TCP三次握手

+ 使用TCP协议进行通信的双方必须先建立连接，然后才能开始传输数据。为了确保连接双方可靠性，在双方建立连接时，TCP协议采用了三次握手策略

![1583073983330](C:\Users\刘如刚\AppData\Roaming\Typora\typora-user-images\1583073983330.png)

+ 第一次握手：客户端发送带有SYN标志的连接请求报文字段，然后进入SYN_SEND状态，等待服务端的确认
+ 第二次握手：服务端接收到客户端的SYN报文段后，需要发送ACK信息对这个SYN报字段进行确认，同时，还要发送自己的SYN请求信息，服务端会将上述的信息放在一个报文段(SYN+ACK报文字段)中，一并发送客户端，此时服务端将进入SYN_RECV状态
+ 第三次握手：客户端接收服务端的SYN+ACK报文段后，会想服务端发送ACK确认报文段，这个报文段发送完毕后，客户端和服务端都进入ESTABLISGED状态完成TCP三次握手

![1583074345568](C:\Users\刘如刚\AppData\Roaming\Typora\typora-user-images\1583074345568.png)

## DNS域名解析

通常我们访问一个网站，使用的是主机名或域名来进行访问的，因为相对于IP地址(一组纯数字)，域名更容易让人记住。但TCP/IP协议使用的是IP地址进行访问的，所以必须有个机制或服务把域名转换成IP地址。DNS服务就是用来解决这个问题的，它提供域名到IP地址之间的解析服务。

![1583074710089](C:\Users\刘如刚\AppData\Roaming\Typora\typora-user-images\1583074710089.png)

## 回溯HTTP数据处理过程

当客户端访问Web站点时，首先会通过DNS服务查询到域名的IP地址。然后浏览器生成HTTP请求，并通过TCP/IP协议发送到web服务器。web服务器接收到请求后会根据请求生成响应内容，并通过TCP/IP协议返回给客户端

![1583074959222](C:\Users\刘如刚\AppData\Roaming\Typora\typora-user-images\1583074959222.png)

HTTP事物处理完整过程

![1583075184150](C:\Users\刘如刚\AppData\Roaming\Typora\typora-user-images\1583075184150.png)

## HTTP协议特点

### 支持客户/服务器模式

客户/服务器模式工作的方式是由客户端向服务器发出请求，服务器端响应请求，并进行响应服务

![1583075586168](C:\Users\刘如刚\AppData\Roaming\Typora\typora-user-images\1583075586168.png)

### 简单快速

+ 客户想服务器请求服务时，只需要传送请求方法和路径
+ 请求方法常用的有GET,HEAD,POST。每种方法规定了客户与服务器联系的类型不同
+ 由于HTTP协议简单，使得HTTP服务器的程序规模小，因而通信速度很快

### 灵活

+ HTTP允许传输任意类型的数据对象
+ 正在传输的类型由Content_Type(Content-Type是HTTP包中用来表示内容类型的标示)加以标示

### 无连接

+ 无连接的含义是限制每次连接只处理一个请求
+ 服务器处理完客户的请求，并收到客户的应答后，即断开连接
+ 采用这种方式可以节省传输时间

### 无状态

+ HTTP协议是无状态协议
+ 无状态是指协议对于事物处理没有记忆能力，缺少状态意味着如果后续处理需要前面的信息，则它必须重传，这样可能导致连接传送的数据量增大
+ 另一方面，在服务器不需要先前信息时，它的应答就较快

